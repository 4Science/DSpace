<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<bean id="itemAuthorityServiceFactory"
		  class="org.dspace.content.authority.factory.ItemAuthorityServiceFactory">

		<property name="authorityServiceImplMap">
			<map>
			    <!-- Specify here any services to use with the relative authority name -->
				<entry key="AuthorAuthority" value-ref="personItemAuthorityFilter" />
				<entry key="EditorAuthority" value-ref="personItemAuthorityFilter" />
				<entry key="AuthorCoarseMatchAuthority" value-ref="personItemAuthorityCoarseMatchFilter" />
				<entry key="AuthorStrictMatchAuthority" value-ref="personItemAuthorityStrictMatchFilter" />
				<entry key="default" value-ref="itemAuthorityFilter" />
			</map>
		</property>
	</bean>

	<bean name="personItemAuthorityFilter" class="org.dspace.content.authority.ItemAuthorityServiceImpl" >
		<property name="customAuthorityFilter" ref="personAuthoritySolrFilter" />
	</bean>
	<bean name="personItemAuthorityCoarseMatchFilter" class="org.dspace.content.authority.ItemAuthorityServiceImpl" >
		<property name="customAuthorityFilter" ref="personCoarseCustomSolrFilter" />
	</bean>
	<bean name="personItemAuthorityStrictMatchFilter" class="org.dspace.content.authority.ItemAuthorityServiceImpl" >
		<property name="customAuthorityFilter" ref="personStrictCustomSolrFilter" />
	</bean>
	<bean name="itemAuthorityFilter" class="org.dspace.content.authority.ItemAuthorityServiceImpl">
		<property name="customAuthorityFilter" ref="itemAuthorityCustomSolrFilter" />
	</bean>

	<bean id="itemControlledVocabularyFactory"
		  class="org.dspace.content.authority.factory.ItemControlledVocabularyFactory">

		<property name="entityMapping">
			<map>
				<!-- Specify here any Item based controlled vocabulary configuration,
				  vocabulary names are defined in item.controlled.vocabularies key-->
				<entry key="orgunits" value-ref="orgunitsControlledVocabulary" />
				<entry key="fonds" value-ref="fondsControlledVocabulary" />
				<entry key="journalfonds" value-ref="journalfondsControlledVocabulary" />
				<entry key="aggregations" value-ref="aggregationsControlledVocabulary" />
				<entry key="fondsTree" value-ref="fondsTree" />
				<entry key="journalfondsTree" value-ref="journalfondsTree" />
				<entry key="aggregationsTree" value-ref="aggregationsTree" />
			</map>
		</property>
	</bean>

	<bean name="orgunitsControlledVocabulary" class="org.dspace.content.authority.ItemControlledVocabulary">
		<property name="entityType" value="OrgUnit"/>
		<property name="parentQuery" value="entityType_keyword:OrgUnit AND -organization.parentOrganization:*"/>
		<property name="childrenQuery" value="organization.parentOrganization_authority:{0}"/>
		<!-- Value mapping -->
		<property name="parentMetadata" value="organization.parentOrganization"/>
		<property name="selectableMetadata" value=""/>
		<property name="labelMetadata">
			<list>
				<value>glamfonds.index</value>
				<value>glamjournalfonds.index</value>
				<value>dc.title</value>
			</list>
		</property>
		<property name="authorityMetadata" value=""/>
		<property name="extraValuesMapper" ref="orgunitsExtraValuesMapper"/>
		<!-- <field_name> <order> - If empty no sorting is made -->
		<property name="sortFields">
			<list>
				<ref bean="sortTitleAsc" />
			</list>
		</property>
	</bean>

	<bean name="fondsControlledVocabulary" class="org.dspace.content.authority.ItemControlledVocabulary">
		<property name="entityType" value="Fonds"/>
		<property name="parentQuery" value="entityType_keyword:Fonds AND -glamfonds.parent:*"/>
		<property name="childrenQuery" value="glamfonds.parent_authority:{0} OR dc.relation.fonds_authority:{0}"/>
		<!-- Value mapping -->
		<property name="parentMetadata" value="glamfonds.parent"/>
		<property name="selectableMetadata" value="glam.leaf"/>
		<property name="storedMetadata">
			<list>
				<value>dc.title</value>
			</list>
		</property>
		<property name="labelMetadata">
			<list>
				<value>glamfonds.index</value>
				<value>glamjournalfonds.index</value>
				<value>dc.title</value>
			</list>
		</property>
		<property name="authorityMetadata" value=""/>
		<property name="extraValuesMapper" ref="fondsExtraValuesMapper"/>
		<!-- <field_name> <order> - If empty no sorting is made -->
		<property name="sortFields">
			<list>
				<ref bean="glamfondsSortIndex" />
				<ref bean="sortTitleAsc" />
			</list>
		</property>
	</bean>

	<bean name="journalfondsControlledVocabulary" class="org.dspace.content.authority.ItemControlledVocabulary">
		<property name="entityType" value="JournalFonds"/>
		<property name="parentQuery" value="entityType_keyword:JournalFonds AND -glamjournalfonds.parent:*"/>
		<property name="childrenQuery" value="glamjournalfonds.parent_authority:{0} OR dc.relation.journalfonds_authority:{0}"/>
		<!-- Value mapping -->
		<property name="parentMetadata" value="glamjournalfonds.parent"/>
		<property name="selectableMetadata" value="glam.leaf"/>
		<property name="storedMetadata">
			<list>
				<value>dc.title</value>
			</list>
		</property>
		<property name="labelMetadata">
			<list>
				<value>glamfonds.index</value>
				<value>glamjournalfonds.index</value>
				<value>dc.title</value>
			</list>
		</property>
		<property name="authorityMetadata" value=""/>
		<property name="extraValuesMapper" ref="journalfondsExtraValuesMapper"/>
		<!-- <field_name> <order> - If empty no sorting is made -->
		<property name="sortFields">
			<list>
				<ref bean="glamjournalfondsSortIndex" />
				<ref bean="sortTitleAsc" />
			</list>
		</property>
	</bean>

	<bean name="aggregationsControlledVocabulary" class="org.dspace.content.authority.ItemControlledVocabulary">
		<property name="entityType" value="Aggregation"/>
		<property name="parentQuery" value="entityType_keyword:Aggregation AND -glamaggregation.parent:*"/>
		<property name="childrenQuery" value="glamaggregation.parent_authority:{0} OR dc.relation.aggregation_authority:{0}"/>
		<!-- Value mapping -->
		<property name="parentMetadata" value="glamaggregation.parent"/>
		<property name="selectableMetadata" value="glam.leaf"/>
		<property name="labelMetadata">
			<list>
				<value>glamfonds.index</value>
				<value>glamjournalfonds.index</value>
				<value>dc.title</value>
			</list>
		</property>
		<property name="storedMetadata">
			<list>
				<value>dc.title</value>
			</list>
		</property>
		<property name="authorityMetadata" value=""/>
		<property name="extraValuesMapper" ref="aggregationsExtraValuesMapper"/>
		<!-- <field_name> <order> - If empty no sorting is made -->
		<property name="sortFields">
			<list>
				<ref bean="sortTitleAsc" />
			</list>
		</property>
	</bean>

	<bean name="fondsTree" parent="fondsControlledVocabulary">
		<property name="childrenQuery" value="entityType_keyword:Fonds AND (glamfonds.parent_authority:{0} OR dc.relation.fonds_authority:{0})"/>
	</bean>

	<bean name="journalfondsTree" parent="journalfondsControlledVocabulary">
		<property name="childrenQuery" value="entityType_keyword:JournalFonds AND (glamjournalfonds.parent_authority:{0} OR dc.relation.journalfonds_authority:{0})"/>
	</bean>

	<bean name="aggregationsTree" parent="aggregationsControlledVocabulary">
		<property name="childrenQuery" value="entityType_keyword:Aggregation AND (glamaggregation.parent_authority:{0} OR dc.relation.aggregation_authority:{0})"/>
	</bean>

	<bean name="orgunitsExtraValuesMapper" class="org.dspace.content.authority.mapper.impl.SimpleMetadataMapper">
		<property name="extraValues">
			<map>
				<entry key="display" value="dc.title" />
				<entry key="note" value="dc.description.abstract" />
			</map>
		</property>
	</bean>

	<bean name="fondsExtraValuesMapper" class="org.dspace.content.authority.mapper.impl.SimpleMetadataMapper">
		<property name="extraValues">
			<map>
				<entry key="display" value="dc.title" />
				<entry key="note" value="dc.description.abstract" />
			</map>
		</property>
	</bean>

	<bean name="journalfondsExtraValuesMapper" class="org.dspace.content.authority.mapper.impl.SimpleMetadataMapper">
		<property name="extraValues">
			<map>
				<entry key="display" value="dc.title" />
				<entry key="note" value="dc.description.abstract" />
			</map>
		</property>
	</bean>

	<bean name="aggregationsExtraValuesMapper" class="org.dspace.content.authority.mapper.impl.SimpleMetadataMapper">
		<property name="extraValues">
			<map>
				<entry key="display" value="dc.title" />
				<entry key="note" value="dc.description.abstract" />
			</map>
		</property>
	</bean>

	<bean name="itemAuthorityCustomSolrFilter" class="org.dspace.content.authority.ItemAuthorityCustomSolrFilterImpl" />
	<bean name="personAuthoritySolrFilter" class="org.dspace.content.authority.PersonAuthoritySolrFilterImpl" />
	<bean name="personStrictCustomSolrFilter" class="org.dspace.content.authority.PersonStrictCustomSolrFilterImpl" />
	<bean name="personCoarseCustomSolrFilter" class="org.dspace.content.authority.PersonCoarseCustomSolrFilterImpl" />

</beans>